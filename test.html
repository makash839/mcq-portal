<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MCQ Test</title>

<style>
body{
  font-family: Arial;
  background:#f2f2f2;
}
.box{
  background:#fff;
  max-width:800px;
  margin:30px auto;
  padding:20px;
  box-shadow:0 0 10px rgba(0,0,0,.2);
}
.option{
  display:block;
  margin:8px 0;
}
button{
  padding:8px 15px;
  margin:5px;
}
.correct{border-left:5px solid green;padding:10px}
.wrong{border-left:5px solid red;padding:10px}
.skipped{border-left:5px solid orange;padding:10px}
</style>
</head>

<body>

<div class="box" id="quizBox">
  <h3 id="qno"></h3>
  <p id="question"></p>
  <div id="options"></div>

  <button onclick="nextQuestion()">Next</button>
  <button onclick="skipQuestion()">Skip</button>
  <button onclick="finalSubmit()">Final Submit</button>
</div>

<div class="box" id="resultBox" style="display:none"></div>

<!-- SUBJECT FILES -->
<script src="data/history.js"></script>
<script src="data/polity.js"></script>
<script src="data/geography.js"></script>

<script>
// ðŸ”¹ GET URL DATA
const params = new URLSearchParams(window.location.search);
const subject = params.get("subject");
const userName = params.get("name");
const userEmail = params.get("email");
const userMobile = params.get("mobile");

let questions = [];

// ðŸ”¹ LOAD SUBJECT QUESTIONS
if(subject === "history") questions = historyQuestions;
else if(subject === "polity") questions = polityQuestions;
else if(subject === "geography") questions = geographyQuestions;
else{
  alert("Invalid subject");
}

// ðŸ”¹ VARIABLES
let index = 0;
let answers = [];
let correct = 0;
let wrong = 0;
let skipped = 0;

// ðŸ”¹ LOAD QUESTION
function loadQuestion(){
  const q = questions[index];
  document.getElementById("qno").innerText =
    `Question ${index+1}/${questions.length}`;
  document.getElementById("question").innerText = q.question;

  const optDiv = document.getElementById("options");
  optDiv.innerHTML = "";

  q.options.forEach((opt,i)=>{
    optDiv.innerHTML += `
      <label class="option">
        <input type="radio" name="opt" value="${i}">
        ${opt}
      </label>`;
  });
}

loadQuestion();

// ðŸ”¹ NEXT
function nextQuestion(){
  const selected =
    document.querySelector("input[name='opt']:checked");

  if(selected){
    answers[index] = parseInt(selected.value);
  }else{
    answers[index] = null;
  }

  index++;
  if(index < questions.length){
    loadQuestion();
  }else{
    finalSubmit();
  }
}

// ðŸ”¹ SKIP
function skipQuestion(){
  answers[index] = null;
  index++;
  if(index < questions.length){
    loadQuestion();
  }else{
    finalSubmit();
  }
}

// ðŸ”¹ FINAL SUBMIT
function finalSubmit(){
  document.getElementById("quizBox").style.display="none";
  const resBox = document.getElementById("resultBox");
  resBox.style.display="block";

  let html = `<h2>Score</h2>`;
  let review = "";

  questions.forEach((q,i)=>{
    const userAns = answers[i];

    if(userAns === null){
      skipped++;
      review += `
        <div class="skipped">
        <b>Q:</b> ${q.question}<br>
        <b>Status:</b> Skipped<br>
        <b>Correct:</b> ${q.options[q.correct]}<br>
        <b>Explanation:</b> ${q.explanation}
        </div>`;
    }
    else if(userAns === q.correct){
      correct++;
      review += `
        <div class="correct">
        <b>Q:</b> ${q.question}<br>
        <b>Status:</b> Correct<br>
        <b>Answer:</b> ${q.options[q.correct]}<br>
        <b>Explanation:</b> ${q.explanation}
        </div>`;
    }
    else{
      wrong++;
      review += `
        <div class="wrong">
        <b>Q:</b> ${q.question}<br>
        <b>Your:</b> ${q.options[userAns]}<br>
        <b>Correct:</b> ${q.options[q.correct]}<br>
        <b>Explanation:</b> ${q.explanation}
        </div>`;
    }
  });

  html += `
    <p><b>Total:</b> ${questions.length}</p>
    <p><b>Correct:</b> ${correct}</p>
    <p><b>Wrong:</b> ${wrong}</p>
    <p><b>Skipped:</b> ${skipped}</p>
    <hr>
    <h3>Question Review</h3>
    ${review}
  `;

  resBox.innerHTML = html;
}
</script>

</body>
</html>
