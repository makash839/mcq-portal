<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>MCQ Test</title>

<style>
body{
  font-family: Arial;
  background:#f2f2f2;
  padding:20px;
}
.box{
  background:#fff;
  max-width:800px;
  margin:auto;
  padding:20px;
}
button{
  padding:8px 15px;
  margin:5px;
}
.option{
  display:block;
  margin:6px 0;
}
</style>
</head>

<body>

<div class="box" id="quizBox">
  <h2 id="subjectTitle"></h2>
  <h3 id="qno"></h3>
  <p id="question"></p>
  <div id="options"></div>

  <button onclick="nextQuestion()">Next</button>
  <button onclick="skipQuestion()">Skip</button>
  <button onclick="finalSubmit()">Final Submit</button>
</div>

<script>
/* üîπ GET SUBJECT */
const params = new URLSearchParams(window.location.search);
const subject = params.get("subject");

let questions = [];
let index = 0;
let correct = 0;
let wrong = 0;
let skipped = 0;
let userAnswers = [];

/* üîπ DYNAMIC SCRIPT LOADER */
function loadScript(src, callback){
  const script = document.createElement("script");
  script.src = src;
  script.onload = callback;
  document.body.appendChild(script);
}

/* üîπ LOAD SUBJECT FILE */
if(subject === "history"){
  loadScript("data/history.js", initTest);
}
else if(subject === "polity"){
  loadScript("data/polity.js", initTest);
}
else if(subject === "geography"){
  loadScript("data/geography.js", initTest);
}
else{
  document.body.innerHTML = "<h2>‚ùå Invalid Subject</h2>";
}

/* üîπ INIT TEST */
function initTest(){
  if(subject === "history") questions = historyQuestions;
  if(subject === "polity") questions = polityQuestions;
  if(subject === "geography") questions = geographyQuestions;

  document.getElementById("subjectTitle").innerText =
    subject.toUpperCase() + " MCQ TEST";

  loadQuestion();
}

/* üîπ LOAD QUESTION */
function loadQuestion(){
  const q = questions[index];

  document.getElementById("qno").innerText =
    `Question ${index+1} / ${questions.length}`;

  document.getElementById("question").innerText = q.question;

  let html = "";
  q.options.forEach((opt,i)=>{
    html += `
      <label class="option">
        <input type="radio" name="opt" value="${i}">
        ${opt}
      </label>`;
  });
  document.getElementById("options").innerHTML = html;
}

function nextQuestion(){
  const selected = document.querySelector('input[name="opt"]:checked');
  userAnswers[index] = selected ? Number(selected.value) : null;

  index++;
  if(index < questions.length){
    loadQuestion();
  }else{
    finalSubmit();
  }
}

function skipQuestion(){
  userAnswers[index] = null;
  skipped++;
  index++;
  if(index < questions.length){
    loadQuestion();
  }else{
    finalSubmit();
  }
}

function finalSubmit(){
  questions.forEach((q,i)=>{
    if(userAnswers[i] === null){
      // skipped
    }
    else if(userAnswers[i] === q.correct){
      correct++;
    }
    else{
      wrong++;
    }
  });

  document.body.innerHTML = `
    <div class="box">
      <h2>Result</h2>
      <p>Total: ${questions.length}</p>
      <p>Correct: ${correct}</p>
      <p>Wrong: ${wrong}</p>
      <p>Skipped: ${questions.length - correct - wrong}</p>
    </div>
  `;
}
</script>

</body>
</html>
